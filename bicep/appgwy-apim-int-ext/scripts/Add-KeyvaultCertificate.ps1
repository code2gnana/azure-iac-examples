Param(
    [string]
    $KeyVaultName,

    [array]
    $PfxCertificates = @(
        [[PSCustomObject]@ {
            Name = 'apipfxcert'
            CertificateString = 'tjdtykftuiglohhufkydjteryktufloh',
            Password = 'sdfsdfsdf'
        }],
        [[PSCustomObject]@ {
            Name = 'portalpfxcert'
            CertificateString = 'kmnjbvcfgjtykfugilytkdkfuigohugy',
            Password = 'lkjlkvxfh'
        }]
    ),

    [array]
    $Certificates = @(
        [[PSCustomObject]@ {
            Name = 'apicert',
            CertificateString = 'kmnjbvcfgjtykfugilytkdkfuigohugy'
        }]
    )
)

$cerContentType = 'application/x-pkix'

$PfxCertificates | Foreach-Object {
    if (-not (Get-AzKeyVaultCertificate -VaultName $KeyVaultName -Name $_.Name)) {
        Import-AzKeyVaultCertificate -VaultName $KeyVaultName -Name $_.Name -CertificateString $_.CertificateString -Password $_.Password
    }
}

$Certificates | 
    Foreach-Object {
        if (-not (Get-AzKeyVaultSecret -VaultName $KeyVaultName -Name $_.Name)) {
            Set-AzKeyVaultSecret -VaultName $KeyVaultName -Name $_.Name -SecretValue $_.CertificateString -ContentType $cerContentType
        }
    }

@"
[{"name": "apipfxcert","certificateString": "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","password": "Compaqtru64"},{"name": "portalpfxcert","certificateString": "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","password": "Compaqtru64}]
"@ | ConvertFrom-Json

@"
[{
    "name": "apicert",
    "certificateString": "sdfdfgdgjfjfdsgfkfghfhfgjdgfjfdghd"
}]
"@ | ConvertFrom-Json